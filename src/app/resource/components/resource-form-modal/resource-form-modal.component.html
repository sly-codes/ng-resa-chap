<div class="modal-overlay">
    <div class="modal-container">
        
        <!-- En-tête de la modale -->
        <div class="modal-header">
            <h2 class="modal-title">
                <i class='bx' [ngClass]="isEditMode ? 'bx-edit' : 'bx-plus-circle'"></i>
                <span>{{ isEditMode ? 'Modifier la ressource' : 'Ajouter une ressource' }}</span>
            </h2>
            <button 
                type="button" 
                class="modal-close" 
                (click)="onCancel()"
                aria-label="Fermer la modale"
            >
                <i class='bx bx-x'></i>
            </button>
        </div>

        <!-- Corps de la modale -->
        <div class="modal-body">
            
            <!-- Loader -->
            <div *ngIf="isLoading" class="modal-loader">
                <i class='bx bx-loader-alt bx-spin'></i>
                <p>Chargement...</p>
            </div>

            <!-- Formulaire -->
            <form 
                *ngIf="!isLoading" 
                [formGroup]="resourceForm!" 
                (ngSubmit)="onSubmit()" 
                class="resource-form"
            >
                
                <!-- Messages d'erreur -->
                <div *ngIf="error" class="modal-error">
                    <i class='bx bx-error-circle'></i>
                    <span>{{ error }}</span>
                </div>

                <!-- Champ Nom -->
                <div class="form-group">
                    <label for="name" class="form-label">
                        Nom de la ressource
                        <span class="label-required">*</span>
                    </label>
                    <input 
                        type="text" 
                        id="name" 
                        formControlName="name" 
                        class="form-input" 
                        placeholder="Ex: Salle de réunion A"
                        autocomplete="off"
                        [class.input-error]="resourceForm!.get('name')?.invalid && (resourceForm!.get('name')?.dirty || resourceForm!.get('name')?.touched)"
                    >
                    <div 
                        *ngIf="resourceForm!.get('name')?.invalid && (resourceForm!.get('name')?.dirty || resourceForm!.get('name')?.touched)" 
                        class="form-error"
                    >
                        <i class='bx bx-error-circle'></i>
                        <span *ngIf="resourceForm!.get('name')?.errors?.['required']">
                            Le nom est requis.
                        </span>
                        <span *ngIf="resourceForm!.get('name')?.errors?.['maxlength']">
                            Le nom ne doit pas dépasser 100 caractères.
                        </span>
                    </div>
                </div>

                <!-- Champ Type -->
                <div class="form-group">
                    <label for="type" class="form-label">
                        Type de ressource
                        <span class="label-required">*</span>
                    </label>
                    <select 
                        id="type" 
                        formControlName="type" 
                        class="form-select"
                        [class.input-error]="resourceForm!.get('type')?.invalid && (resourceForm!.get('type')?.dirty || resourceForm!.get('type')?.touched)"
                    >
                        <option value="" disabled>Sélectionnez un type</option>
                        <option value="ROOM">Salle</option>
                        <option value="EQUIPMENT">Équipement</option>
                    </select>
                    <div 
                        *ngIf="resourceForm!.get('type')?.invalid && (resourceForm!.get('type')?.dirty || resourceForm!.get('type')?.touched)" 
                        class="form-error"
                    >
                        <i class='bx bx-error-circle'></i>
                        Le type est requis.
                    </div>
                </div>

                <!-- Champ Description -->
                <div class="form-group">
                    <label for="description" class="form-label">
                        Description
                        <span class="label-optional">(Optionnel)</span>
                    </label>
                    <textarea 
                        id="description" 
                        formControlName="description" 
                        class="form-textarea" 
                        placeholder="Décrivez la ressource..."
                        rows="4"
                    ></textarea>
                    <div class="form-hint">
                        Détails, capacités, emplacement...
                    </div>
                </div>

            </form>
        </div>

        <!-- Pied de la modale -->
        <div class="modal-footer">
            <button 
                type="button" 
                class="btn-cancel" 
                (click)="onCancel()"
                [disabled]="isLoading"
            >
                <i class='bx bx-x'></i>
                <span>Annuler</span>
            </button>
            <button 
                type="submit" 
                class="btn-submit" 
                (click)="onSubmit()"
                [disabled]="resourceForm!.invalid || isLoading"
            >
                <i class='bx' [ngClass]="isLoading ? 'bx-loader-alt bx-spin' : 'bx-save'"></i>
                <span>{{ isLoading ? 'Enregistrement...' : (isEditMode ? 'Mettre à jour' : 'Créer') }}</span>
            </button>
        </div>

    </div>
</div>