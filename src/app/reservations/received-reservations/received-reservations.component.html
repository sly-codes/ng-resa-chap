<div class="reservations-container">
  <!-- üìã En-t√™te -->
  <h1 class="reservations-title">
    <i class="bx bx-list-check"></i>
    <span>R√©servations Re√ßues</span>
  </h1>

  <!-- üîÑ Loader -->
  <div *ngIf="isLoading" class="reservations-loader">
    <i class="bx bx-loader-alt bx-spin"></i>
    <p>Chargement des demandes de r√©servation...</p>
  </div>

  <!-- üö® Message d'erreur -->
  <div *ngIf="error" class="reservations-error">
    {{ error }}
  </div>

  <!-- üìä Liste des r√©servations -->
  <ng-container *ngIf="reservations$ | async as reservations">
    <!-- üì≠ √âtat vide -->
    <div *ngIf="reservations.length === 0 && !isLoading" class="reservations-empty">
      <i class="bx bx-check-circle"></i>
      <p>Vous n'avez aucune demande de r√©servation en attente.</p>
    </div>

    <!-- üìä Tableau des r√©servations -->
    <div *ngIf="reservations.length > 0" class="reservations-table-wrapper">
      <table class="reservations-table">
        <thead>
          <tr>
            <th scope="col">Ressource</th>
            <th scope="col">Demandeur</th>
            <th scope="col">P√©riode Demand√©e</th>
            <th scope="col">Statut</th>
            <th scope="col" class="text-center">D√©cision</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let res of reservations">
            <!-- Ressource -->
            <td>
              <div class="resource-info">
                <span class="resource-name">{{ res.resource.name }}</span>
                <span class="resource-type">{{ res.resource.type }}</span>
              </div>
            </td>

            <!-- Demandeur -->
            <td>
              <div class="user-info">
                <span class="user-email">{{ res.locataire.email }}</span>
                <span class="user-name">{{ res.locataire.username }}</span>
              </div>
            </td>

            <!-- P√©riode -->
            <td>
              <div class="period-info">
                <span class="period-date"
                  >{{ res.dateDebut | date : 'dd/MM/yyyy' }} -
                  {{ res.dateFin | date : 'dd/MM/yyyy' }}</span
                >
                <span class="period-time">
                  {{ res.dateDebut | date : 'HH:mm' }} - {{ res.dateFin | date : 'HH:mm' }}
                </span>
              </div>
            </td>

            <!-- Statut -->
            <td>
              <span
                class="status-badge"
                [ngClass]="{
                  'status-pending': res.status === 'PENDING',
                  'status-approved': res.status === 'CONFIRMED',
                  'status-rejected': res.status === 'REJECTED',
                  'status-cancelled': res.status === 'CANCELED'
                }"
              >
                {{ getReservationStatusText(res.status) }}
              </span>
            </td>

            <!-- Actions -->
            <td class="text-center">
              <div *ngIf="res.status === 'PENDING'" class="reservation-actions">
                <button
                  (click)="onApprove(res.id)"
                  class="btn-approve"
                  [disabled]="res.isProcessing"
                  title="Accepter la r√©servation"
                >
                  <i
                    class="bx"
                    [ngClass]="res.isProcessing ? 'bx-loader-alt bx-spin' : 'bx-check'"
                  ></i>
                  <span>Accepter</span>
                </button>
                <button
                  (click)="onReject(res.id)"
                  class="btn-reject"
                  [disabled]="res.isProcessing"
                  title="Refuser la r√©servation"
                >
                  <i class="bx" [ngClass]="res.isProcessing ? 'bx-loader-alt bx-spin' : 'bx-x'"></i>
                  <span>Refuser</span>
                </button>
              </div>
              <div *ngIf="res.status !== 'PENDING'" class="reservation-status-final">
                <span class="text-muted">‚Äî</span>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </ng-container>
</div>
