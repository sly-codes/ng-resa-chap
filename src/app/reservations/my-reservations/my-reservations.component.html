<div class="reservations-container">
  <!-- üìã En-t√™te -->
  <h1 class="reservations-title">
    <i class="bx bx-book-bookmark"></i>
    <span>Mes R√©servations</span>
  </h1>

  <!-- üîÑ Loader -->
  <div *ngIf="isLoading" class="reservations-loader">
    <i class="bx bx-loader-alt bx-spin"></i>
    <p>Chargement de vos r√©servations...</p>
  </div>

  <!-- üö® Message d'erreur -->
  <div *ngIf="error" class="reservations-error">
    {{ error }}
  </div>

  <!-- üìä Liste des r√©servations -->
  <ng-container *ngIf="reservations$ | async as reservations">
    <!-- üì≠ √âtat vide -->
    <div *ngIf="reservations.length === 0 && !isLoading" class="reservations-empty">
      <i class="bx bx-calendar-minus"></i>
      <p>Vous n'avez effectu√© aucune r√©servation pour le moment.</p>
    </div>

    <!-- üìä Tableau des r√©servations -->
    <div *ngIf="reservations.length > 0" class="reservations-table-wrapper">
      <table class="reservations-table">
        <thead>
          <tr>
            <th scope="col">Ressource R√©serv√©e</th>
            <th scope="col">P√©riode</th>
            <th scope="col">Statut</th>
            <th scope="col" class="text-center">Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let res of reservations">
            <!-- Ressource -->
            <td>
              <div class="resource-info-row">
                <i [class]="'bx ' + getResourceIcon(res.resource.type)" class="resource-icon"></i>
                <div class="resource-details">
                  <span class="resource-name">{{ res.resource.name }}</span>
                  <span class="resource-owner">Locateur: {{ res.resource.owner.email }}</span>
                </div>
              </div>
            </td>

            <!-- P√©riode -->
            <td>
              <div class="period-info">
                <span class="period-date"
                  >{{ res.dateDebut | date : 'dd/MM/yyyy' }} -
                  {{ res.dateFin | date : 'dd/MM/yyyy' }}</span
                >
                <span class="period-time">
                  {{ res.dateDebut | date : 'HH:mm' }} - {{ res.dateFin | date : 'HH:mm' }}
                </span>
              </div>
            </td>

            <!-- Statut -->
            <td>
              <span
                class="status-badge"
                [ngClass]="{
                  'status-pending': res.status === 'PENDING',
                  'status-approved': res.status === 'CONFIRMED',
                  'status-rejected': res.status === 'REJECTED',
                  'status-cancelled': res.status === 'CANCELED'
                }"
              >
                {{ getReservationStatusText(res.status) }}
              </span>
            </td>

            <!-- Actions -->
            <td class="text-center">
              <div class="reservation-actions">
                <button
                  *ngIf="res.status === 'PENDING'"
                  (click)="onCancelReservation(res.id)"
                  class="btn-cancel"
                  [disabled]="res.isCancelling"
                  title="Annuler la r√©servation"
                >
                  <i class="bx" [ngClass]="res.isCancelling ? 'bx-loader-alt bx-spin' : 'bx-x'"></i>
                  <span>Annuler</span>
                </button>
                <div *ngIf="res.status !== 'PENDING'" class="reservation-status-final">
                  <span class="text-muted">‚Äî</span>
                </div>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </ng-container>
</div>
